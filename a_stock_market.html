<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>A股市场概览</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: "PingFang SC", "Microsoft YaHei", sans-serif;
        }
        
        :root {
            --primary-color: #e74c3c;
            --green-color: #27ae60;
            --red-color: #e74c3c;
            --gray-color: #f8f9fa;
            --border-color: #eaecef;
            --text-color: #24292e;
            --light-text: #586069;
        }
        
        body {
            background-color: #f8f9fa;
            color: var(--text-color);
            line-height: 1.5;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 8px;
        }
        
        header {
            background-color: white;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
            padding: 12px 0;
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .header-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo {
            font-size: 1.4rem;
            font-weight: bold;
            color: var(--primary-color);
        }
        
        .update-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .update-time {
            font-size: 0.9rem;
            color: var(--light-text);
        }
        
        .market-index {
            display: flex;
            overflow-x: auto;
            padding: 12px 0;
            gap: 12px;
            margin-bottom: 12px;
        }
        
        .index-card {
            background-color: white;
            border-radius: 6px;
            padding: 10px 12px;
            min-width: 160px;
            box-shadow: 0 1px 2px rgba(0,0,0,0.05);
            border: 1px solid var(--border-color);
        }
        
        .index-name {
            font-size: 0.85rem;
            color: var(--light-text);
        }
        
        .index-value {
            font-size: 1.1rem;
            font-weight: bold;
            margin: 4px 0;
        }
        
        .index-change {
            font-size: 0.8rem;
            padding: 2px 6px;
            border-radius: 4px;
            display: inline-block;
        }
        
        .positive {
            background-color: rgba(231, 76, 60, 0.1);
            color: var(--red-color);
        }
        
        .negative {
            background-color: rgba(39, 174, 96, 0.1);
            color: var(--green-color);
        }

        /* 趋势分析样式 */
        .trend-analysis {
            background-color: white;
            border-radius: 6px;
            padding: 16px;
            margin-bottom: 12px;
            box-shadow: 0 1px 2px rgba(0,0,0,0.05);
            border: 1px solid var(--border-color);
        }

        .trend-title {
            font-size: 1.1rem;
            font-weight: bold;
            margin-bottom: 12px;
            color: var(--text-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .trend-status {
            font-size: 0.85rem;
            padding: 3px 6px;
            border-radius: 4px;
            font-weight: normal;
        }

        .trend-chart {
            width: 100%;
            height: 220px;
            margin: 12px 0;
            background-color: #f9f9f9;
            border-radius: 4px;
            overflow: hidden;
            border: 1px solid var(--border-color);
        }

        .trend-info {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            margin-top: 12px;
        }

        .trend-item {
            flex: 1;
            min-width: 180px;
            padding: 8px;
            background-color: #f9f9f9;
            border-radius: 4px;
            border: 1px solid var(--border-color);
        }

        .trend-item-title {
            font-size: 0.85rem;
            color: var(--light-text);
            margin-bottom: 4px;
        }

        .trend-item-value {
            font-size: 1rem;
            font-weight: bold;
        }

        /* 龙头板块样式 */
        .leading-sectors {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-bottom: 12px;
        }

        .sector-card {
            background-color: white;
            border-radius: 6px;
            padding: 12px;
            box-shadow: 0 1px 2px rgba(0,0,0,0.05);
            border: 1px solid var(--border-color);
        }

        .sector-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
            padding-bottom: 8px;
            border-bottom: 1px solid var(--border-color);
        }

        .sector-title {
            font-size: 1rem;
            font-weight: bold;
            color: var(--text-color);
        }

        .sector-change {
            font-size: 0.85rem;
            padding: 2px 6px;
            border-radius: 4px;
        }

        .sector-stocks {
            display: flex;
            overflow-x: auto;
            gap: 8px;
            padding: 4px 0;
        }

        .stock-card {
            min-width: 140px;
            padding: 8px;
            border-radius: 4px;
            background-color: #f9f9f9;
            border: 1px solid var(--border-color);
        }

        .stock-name {
            font-size: 0.85rem;
            margin-bottom: 4px;
            color: var(--text-color);
        }
        
        /* 新增：板块中股票名称和代码样式增强 */
        .sector-stocks .stock-name {
            font-size: 0.9rem;
            font-weight: 600;
            color: #333;
            margin-bottom: 5px;
        }

        .stock-code {
            color: var(--light-text);
            font-size: 0.75rem;
            margin-bottom: 4px;
        }
        
        /* 新增：板块中股票代码样式增强 */
        .sector-stocks .stock-code {
            color: #2980b9;
            font-size: 0.8rem;
            font-weight: 500;
            margin-bottom: 6px;
            background-color: rgba(41, 128, 185, 0.08);
            padding: 2px 4px;
            border-radius: 3px;
            display: inline-block;
        }

        .stock-price {
            font-weight: bold;
        }

        /* 增加价格和涨跌幅之间的间距 */
        .price-spacing {
            margin-right: 12px;
            display: inline-block;
        }
        
        /* 调整股票表格中的间距 */
        td .price-spacing {
            margin-right: 10px;
        }
        
        /* 股票卡片中价格间距 */
        .stock-price .price-value {
            margin-right: 12px;
            display: inline-block;
        }
        
        .stock-price .change-value {
            display: inline-block;
        }
        
        /* 非必要但提供多重保证的分隔符 */
        .price-separator {
            display: inline-block;
            width: 12px;
        }

        .leader-badge {
            display: inline-block;
            background-color: #3498db;
            color: white;
            font-size: 0.7rem;
            padding: 1px 4px;
            border-radius: 2px;
            margin-left: 4px;
            vertical-align: middle;
        }
        
        .control-panel {
            background-color: white;
            border-radius: 6px;
            padding: 12px;
            margin-bottom: 12px;
            box-shadow: 0 1px 2px rgba(0,0,0,0.05);
            border: 1px solid var(--border-color);
        }
        
        .search-container {
            display: flex;
            gap: 8px;
            margin-bottom: 8px;
        }
        
        input, select, button {
            padding: 8px 12px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            font-size: 0.85rem;
        }
        
        input {
            flex: 1;
        }
        
        button {
            background-color: var(--primary-color);
            color: white;
            border: none;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        
        button:hover {
            background-color: #c0392b;
        }
        
        /* 添加重置按钮样式 */
        button.reset-button {
            background-color: #7f8c8d;
        }
        
        button.reset-button:hover {
            background-color: #636e72;
        }
        
        .filter-options {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }
        
        .stock-table-container {
            background-color: white;
            border-radius: 6px;
            overflow: hidden;
            box-shadow: 0 1px 2px rgba(0,0,0,0.05);
            margin-bottom: 12px;
            border: 1px solid var(--border-color);
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            text-align: left;
        }
        
        th, td {
            padding: 10px 12px;
            border-bottom: 1px solid var(--border-color);
        }
        
        th {
            background-color: #f8f9fa;
            font-weight: 600;
            position: sticky;
            top: 57px;
            cursor: pointer;
            font-size: 0.85rem;
        }
        
        th:hover {
            background-color: #f0f2f5;
        }
        
        tr:hover {
            background-color: var(--gray-color);
        }
        
        td {
            font-size: 0.9rem;
        }
        
        .stock-code {
            color: var(--light-text);
            font-size: 0.85rem;
        }
        
        /* 分页样式优化 */
        .pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-top: 16px;
            gap: 4px;
            flex-wrap: wrap;
            padding: 10px 0;
        }
        
        .pagination-info {
            margin-right: 15px;
            font-size: 0.85rem;
            color: #666;
            font-weight: bold;
        }
        
        .pagination-buttons {
            display: flex;
            gap: 8px;
            align-items: center;
        }
        
        .pagination button {
            min-width: 36px;
            height: 36px;
            padding: 0 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            border: 1px solid #ddd;
            background-color: #fff;
            transition: all 0.2s;
            border-radius: 4px;
            font-size: 0.9rem;
            color: #333; /* 添加明确的文字颜色 */
            font-weight: 500;
        }
        
        .pagination button:hover {
            background-color: #f5f5f5;
            border-color: #e74c3c;
            color: #e74c3c; /* 悬停时的文字颜色 */
        }
        
        .pagination button.active {
            background-color: #e74c3c;
            color: white;
            font-weight: bold;
            border-color: #e74c3c;
        }
        
        .pagination button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .pagination .ellipsis {
            margin: 0 5px;
            color: #666;
            font-size: 1.2rem;
            align-self: flex-end;
            line-height: 1;
        }
        
        /* 跳转到页面输入框样式 */
        .pagination .jump-container {
            display: flex;
            align-items: center;
            margin-left: 15px;
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 4px 8px;
            background-color: #f9f9f9;
        }
        
        .pagination .jump-label {
            font-size: 0.85rem;
            margin-right: 5px;
            color: #333;
        }
        
        .pagination .jump-input {
            width: 60px; /* 增大输入框宽度 */
            height: 32px; /* 增大输入框高度 */
            text-align: center;
            border: 1px solid #ddd;
            border-radius: 3px;
            margin-right: 8px; /* 增加右侧间距 */
            font-size: 1rem; /* 增大字体 */
            padding: 0 5px; /* 添加内边距 */
        }
        
        .pagination .jump-button {
            height: 32px; /* 增大按钮高度 */
            min-width: 60px; /* 设置最小宽度 */
            padding: 0 12px; /* 增加内边距 */
            background-color: #e74c3c;
            color: white;
            border: none;
            border-radius: 3px;
            cursor: pointer;
            font-size: 0.9rem; /* 增大字体 */
            font-weight: bold; /* 加粗文字 */
        }
        
        .pagination .jump-button:hover {
            background-color: #c0392b;
        }

        .loading {
            text-align: center;
            padding: 12px;
            font-size: 1rem;
            color: var(--light-text);
            background-color: rgba(255,255,255,0.8);
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            border-radius: 4px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            border: 1px solid var(--border-color);
            z-index: 10;
        }
        
        /* 修复加载指示器的位置问题 */
        .trend-chart .loading {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            padding: 8px 16px;
            font-size: 0.9rem;
            z-index: 20;
        }
        
        /* 空数据提示样式 */
        .empty-data-message {
            text-align: center;
            padding: 20px;
            color: #e74c3c;
            font-size: 0.95rem;
        }
        
        footer {
            text-align: center;
            padding: 16px;
            margin-top: 24px;
            font-size: 0.85rem;
            color: var(--light-text);
        }

        /* 标签样式 */
        .tabs {
            display: flex;
            border-bottom: 1px solid var(--border-color);
            margin-bottom: 12px;
        }

        .tab {
            padding: 8px 12px;
            cursor: pointer;
            border-bottom: 2px solid transparent;
            transition: all 0.2s;
            font-size: 0.9rem;
        }

        .tab.active {
            border-bottom-color: var(--primary-color);
            color: var(--primary-color);
            font-weight: bold;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }
        
        @media (max-width: 768px) {
            .header-container {
                flex-direction: column;
                align-items: flex-start;
                gap: 8px;
            }
            
            .search-container, .filter-options {
                flex-direction: column;
            }
            
            .index-card {
                min-width: 130px;
            }
            
            th, td {
                padding: 6px 8px;
                font-size: 0.85rem;
            }
            
            .control-panel {
                padding: 8px;
            }

            .trend-info {
                flex-direction: column;
            }

            .sector-stocks {
                flex-direction: column;
            }

            .stock-card {
                min-width: auto;
            }
        }

        /* 股票表格标题 */
        .stock-table-title {
            font-size: 1.1rem;
            font-weight: bold;
            padding: 12px;
            border-bottom: 1px solid var(--border-color);
            background-color: #f8f9fa;
            color: var(--text-color);
        }

        /* 可点击的股票名称和代码样式 */
        .clickable {
            cursor: pointer;
            text-decoration: underline;
            color: #3498db;
            transition: color 0.2s;
        }

        .clickable:hover {
            color: #2980b9;
        }

        /* 股票详情模态窗口样式 */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            overflow: auto;
        }

        .modal-content {
            background-color: #fff;
            margin: 10% auto;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            width: 80%;
            max-width: 600px;
            position: relative;
            animation: modalOpen 0.3s ease-out;
        }

        @keyframes modalOpen {
            from {opacity: 0; transform: scale(0.9);}
            to {opacity: 1; transform: scale(1);}
        }

        .close-modal {
            position: absolute;
            right: 15px;
            top: 10px;
            font-size: 24px;
            font-weight: bold;
            cursor: pointer;
            color: #666;
            z-index: 10; /* 确保在最上层 */
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: white;
            border-radius: 50%;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .close-modal:hover {
            color: #000;
            background-color: #f5f5f5;
        }

        .stock-detail-header {
            display: flex;
            justify-content: space-between;
            border-bottom: 1px solid #eee;
            padding-bottom: 12px;
            margin-bottom: 16px;
            padding-right: 30px; /* 为关闭按钮预留空间 */
        }

        .stock-detail-title {
            font-size: 1.5rem;
            font-weight: bold;
            color: #333;
        }

        .stock-detail-code {
            font-size: 1rem;
            color: #666;
            margin-top: 8px;
            background-color: #f5f5f5;
            display: inline-flex;
            align-items: center;
            padding: 4px 12px;
            border-radius: 4px;
            border: 1px solid #e0e0e0;
            font-weight: 500;
            color: #2980b9;
            letter-spacing: 1px;
        }

        .stock-detail-price {
            font-size: 1.8rem;
            font-weight: bold;
            margin-right: 8px;
        }

        .stock-detail-change {
            padding: 3px 8px;
            border-radius: 4px;
            font-weight: bold;
            margin-top: 4px;
            display: inline-block;
        }

        .stock-detail-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
            margin-top: 16px;
        }

        .detail-item {
            display: flex;
            flex-direction: column;
            background-color: #f9f9f9;
            padding: 12px;
            border-radius: 4px;
        }

        .detail-label {
            font-size: 0.85rem;
            color: #666;
            margin-bottom: 4px;
        }

        .detail-value {
            font-size: 1.1rem;
            font-weight: 500;
            color: #333;
        }

        /* 新增：股票趋势分析看板样式 */
        .stock-trend-dashboard {
            margin-top: 20px;
            border-top: 1px solid var(--border-color);
            padding-top: 16px;
        }

        .dashboard-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .dashboard-header h3 {
            font-size: 1.1rem;
            font-weight: bold;
            color: #333;
            margin: 0;
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
        }

        .dashboard-card {
            background-color: #f9f9f9;
            border-radius: 6px;
            border: 1px solid var(--border-color);
            overflow: hidden;
        }

        .card-header {
            background-color: #f0f2f5;
            padding: 10px 12px;
            font-weight: bold;
            font-size: 0.95rem;
            border-bottom: 1px solid var(--border-color);
        }

        .card-content {
            padding: 12px;
            max-height: 200px;
            overflow-y: auto;
        }

        .trend-item-row {
            display: flex;
            justify-content: space-between;
            padding: 6px 0;
            border-bottom: 1px dashed #eee;
        }

        .trend-item-name {
            font-size: 0.9rem;
            font-weight: 500;
        }

        .trend-item-value {
            font-weight: bold;
        }

        .trend-value-up {
            color: var(--red-color);
        }

        .trend-value-down {
            color: var(--green-color);
        }

        .loading-small {
            font-size: 0.85rem;
            text-align: center;
            color: #888;
            padding: 10px;
        }

        .indicator-line {
            margin: 8px 0;
        }

        .indicator-title {
            font-size: 0.85rem;
            margin-bottom: 4px;
        }

        .indicator-value {
            display: flex;
            align-items: center;
        }

        .indicator-bar {
            height: 6px;
            border-radius: 3px;
            background-color: #eee;
            width: 100%;
            position: relative;
            margin-top: 4px;
        }

        .indicator-progress {
            position: absolute;
            left: 0;
            top: 0;
            height: 100%;
            border-radius: 3px;
        }

        .indicator-bull {
            background-color: var(--red-color);
        }

        .indicator-bear {
            background-color: var(--green-color);
        }

        .indicator-neutral {
            background-color: #f39c12;
        }
        
        /* 实时刷新按钮样式 */
        .refresh-realtime {
            background-color: #3498db;
            color: white;
            padding: 6px 12px;
            border-radius: 4px;
            font-size: 0.85rem;
            font-weight: bold;
            cursor: pointer;
            border: none;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            transition: background-color 0.2s;
        }
        
        .refresh-realtime:hover {
            background-color: #2980b9;
        }
        
        .refresh-realtime.loading {
            background-color: #95a5a6;
            cursor: not-allowed;
        }
        
        .refresh-icon {
            animation: none;
        }
        
        .refreshing .refresh-icon {
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        @media (max-width: 768px) {
            .dashboard-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="container header-container">
            <div class="logo">A股市场概览</div>
            <div class="update-info">
                <button id="realTimeRefresh" class="refresh-realtime">
                    <svg class="refresh-icon" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M23 4v6h-6"></path>
                        <path d="M1 20v-6h6"></path>
                        <path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10"></path>
                        <path d="M1 14l4.64 4.36A9 9 0 0 0 20.49 15"></path>
                    </svg>
                    实时刷新
                </button>
                <span class="update-time" id="updateTime">更新时间：--</span>
            </div>
        </div>
    </header>
    
    <main class="container">
        <section class="market-index" id="marketIndex">
            <!-- 市场指数将通过JavaScript动态生成 -->
        </section>
        
        <!-- 新增：A股趋势分析 -->
        <section class="trend-analysis">
            <div class="trend-title">
                A股市场趋势分析
                <span id="marketTrend" class="trend-status positive">偏多</span>
            </div>
            <div class="trend-chart" id="trendChart">
                <!-- 这里将通过JS绘制趋势图 -->
            </div>
            <div class="trend-info">
                <div class="trend-item">
                    <div class="trend-item-title">市场情绪</div>
                    <div class="trend-item-value" id="marketSentiment">--</div>
                </div>
                <div class="trend-item">
                    <div class="trend-item-title">北向资金(亿)</div>
                    <div class="trend-item-value" id="northwardFunds">--</div>
                </div>
                <div class="trend-item">
                    <div class="trend-item-title">涨跌比</div>
                    <div class="trend-item-value" id="advanceDeclineRatio">--</div>
                </div>
                <div class="trend-item">
                    <div class="trend-item-title">大盘趋势</div>
                    <div class="trend-item-value" id="marketTrend2">--</div>
                </div>
            </div>
            
            <!-- 新增：股票趋势分析看板 -->
            <div class="stock-trend-dashboard">
                <div class="dashboard-header">
                    <h3>股票趋势分析看板</h3>
                    <span class="update-time" id="dashboardUpdateTime">更新时间: --</span>
                </div>
                <div class="dashboard-grid">
                    <div class="dashboard-card">
                        <div class="card-header">热门板块</div>
                        <div class="card-content" id="hotSectors">
                            <div class="loading-small">加载中...</div>
                        </div>
                    </div>
                    <div class="dashboard-card">
                        <div class="card-header">领涨个股</div>
                        <div class="card-content" id="topGainers">
                            <div class="loading-small">加载中...</div>
                        </div>
                    </div>
                    <div class="dashboard-card">
                        <div class="card-header">成交量异动</div>
                        <div class="card-content" id="volumeChange">
                            <div class="loading-small">加载中...</div>
                        </div>
                    </div>
                    <div class="dashboard-card">
                        <div class="card-header">技术指标分析</div>
                        <div class="card-content" id="technicalIndicators">
                            <div class="loading-small">加载中...</div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- 新增：龙头板块展示 -->
        <section class="sector-section">
            <div class="tabs">
                <div class="tab active" data-tab="leading-sectors">龙头板块</div>
                <div class="tab" data-tab="industry-sectors">行业分类</div>
                <div class="tab" data-tab="leading-stocks">龙头股票</div>
            </div>
            
            <div id="leading-sectors" class="tab-content active leading-sectors">
                <!-- 龙头板块将通过JavaScript动态生成 -->
            </div>
            
            <div id="industry-sectors" class="tab-content leading-sectors">
                <!-- 行业分类将通过JavaScript动态生成 -->
            </div>
            
            <div id="leading-stocks" class="tab-content stock-table-container">
                <div class="stock-table-title">龙头股票一览</div>
                <table>
                    <thead>
                        <tr>
                            <th>股票代码</th>
                            <th>股票名称</th>
                            <th>所属板块</th>
                            <th>最新价(元)</th>
                            <th>涨跌幅</th>
                            <th>市盈率(倍)</th>
                        </tr>
                    </thead>
                    <tbody id="leadingStocksList">
                        <!-- 龙头股票列表将通过JavaScript动态生成 -->
                    </tbody>
                </table>
            </div>
        </section>
        
        <section class="control-panel">
            <div class="search-container">
                <input type="text" id="searchInput" placeholder="输入股票代码或名称搜索">
                <button id="searchBtn">搜索</button>
                <button class="reset-button">重置</button>
            </div>
            <div class="filter-options">
                <select id="industryFilter">
                    <option value="">全部行业</option>
                    <!-- 行业选项将通过JavaScript动态生成 -->
                </select>
                <select id="sortOption">
                    <option value="default">默认排序</option>
                    <option value="priceAsc">价格 ↑</option>
                    <option value="priceDesc">价格 ↓</option>
                    <option value="changeAsc">涨跌幅 ↑</option>
                    <option value="changeDesc">涨跌幅 ↓</option>
                    <option value="volumeDesc">成交量 ↓</option>
                </select>
                <button id="refreshBtn">刷新数据</button>
            </div>
        </section>
        
        <section class="stock-table-container">
            <div class="stock-table-title">A股市场行情</div>
            <table id="stockTable">
                <thead>
                    <tr>
                        <th data-sort="code">股票代码</th>
                        <th data-sort="name">股票名称</th>
                        <th data-sort="price">最新价(元)</th>
                        <th data-sort="change">涨跌幅</th>
                        <th data-sort="volume">成交量(万手)</th>
                        <th data-sort="turnover">成交额(亿)</th>
                        <th data-sort="pe">市盈率(倍)</th>
                    </tr>
                </thead>
                <tbody id="stockList">
                    <!-- 股票数据将通过JavaScript动态生成 -->
                </tbody>
            </table>
            <div id="loading" class="loading">加载中...</div>
        </section>
        
        <div class="pagination" id="pagination">
            <!-- 分页按钮将通过JavaScript动态生成 -->
        </div>
    </main>
    
    <footer>
        <p>数据仅供参考，非实时行情，实际交易以交易所数据为准</p>
        <p>建议使用专业股票软件或券商App获取准确实时数据</p>
    </footer>

    <script>
        // 更新到最新的A股数据 (模拟数据，非实时)
        const stockIndices = [
            { name: '上证指数', code: '000001.SH', value: 3512.87, change: 35.68, changePercent: 1.03 },
            { name: '深证成指', code: '399001.SZ', value: 10765.34, change: 98.65, changePercent: 0.92 },
            { name: '创业板指', code: '399006.SZ', value: 2185.21, change: 22.56, changePercent: 1.04 },
            { name: '科创50', code: '000688.SH', value: 968.42, change: 12.57, changePercent: 1.32 },
            { name: '沪深300', code: '000300.SH', value: 3812.65, change: 45.78, changePercent: 1.22 }
        ];

        // 龙头板块数据
        const leadingSectors = [
            { 
                name: '半导体', 
                change: 3.15, 
                stocks: [
                    { code: '688981', name: '中芯国际', price: 58.42, change: 3.65, changePercent: 6.67, isLeader: true, pe: 28.75, industry: '半导体' },
                    { code: '002049', name: '紫光国微', price: 128.75, change: 4.32, changePercent: 3.47, isLeader: true, pe: 42.15, industry: '半导体' },
                    { code: '688012', name: '中微公司', price: 92.37, change: 2.85, changePercent: 3.18, isLeader: false, pe: 72.45, industry: '半导体' },
                    { code: '002371', name: '北方华创', price: 167.85, change: 3.95, changePercent: 2.41, isLeader: false, pe: 78.22, industry: '半导体' }
                ]
            },
            { 
                name: '新能源', 
                change: 2.35, 
                stocks: [
                    { code: '300750', name: '宁德时代', price: 187.32, change: 4.25, changePercent: 2.32, isLeader: true, pe: 35.87, industry: '新能源' },
                    { code: '601012', name: '隆基绿能', price: 45.18, change: 1.65, changePercent: 3.79, isLeader: true, pe: 19.85, industry: '新能源' },
                    { code: '002594', name: '比亚迪', price: 252.85, change: 4.28, changePercent: 1.72, isLeader: true, pe: 42.68, industry: '新能源' },
                    { code: '688005', name: '容百科技', price: 59.87, change: 1.05, changePercent: 1.79, isLeader: false, pe: 39.54, industry: '新能源' }
                ]
            },
            { 
                name: '人工智能', 
                change: 3.78, 
                stocks: [
                    { code: '000977', name: '浪潮信息', price: 36.42, change: 1.25, changePercent: 3.55, isLeader: true, pe: 48.32, industry: '人工智能' },
                    { code: '002230', name: '科大讯飞', price: 45.65, change: 1.75, changePercent: 3.99, isLeader: true, pe: 72.35, industry: '人工智能' },
                    { code: '300454', name: '深信服', price: 135.42, change: 3.25, changePercent: 2.46, isLeader: false, pe: 58.76, industry: '人工智能' },
                    { code: '002415', name: '海康威视', price: 33.45, change: 0.98, changePercent: 3.02, isLeader: false, pe: 22.87, industry: '人工智能' }
                ]
            },
            { 
                name: '医药生物', 
                change: 1.35, 
                stocks: [
                    { code: '600276', name: '恒瑞医药', price: 34.12, change: 0.35, changePercent: 1.04, isLeader: true, pe: 33.21, industry: '医药生物' },
                    { code: '300760', name: '迈瑞医疗', price: 252.75, change: 3.15, changePercent: 1.26, isLeader: true, pe: 41.25, industry: '医药生物' },
                    { code: '603259', name: '药明康德', price: 89.65, change: 1.65, changePercent: 1.87, isLeader: false, pe: 43.58, industry: '医药生物' },
                    { code: '300142', name: '沃森生物', price: 43.85, change: 0.42, changePercent: 0.97, isLeader: false, pe: 49.87, industry: '医药生物' }
                ]
            },
            { 
                name: '消费', 
                change: 1.05, 
                stocks: [
                    { code: '600519', name: '贵州茅台', price: 1678.45, change: 18.75, changePercent: 1.13, isLeader: true, pe: 27.32, industry: '消费' },
                    { code: '000858', name: '五粮液', price: 176.32, change: 3.12, changePercent: 1.80, isLeader: true, pe: 22.15, industry: '消费' },
                    { code: '601888', name: '中国中免', price: 157.85, change: 1.45, changePercent: 0.93, isLeader: true, pe: 29.85, industry: '消费' },
                    { code: '600887', name: '伊利股份', price: 28.65, change: 0.32, changePercent: 1.13, isLeader: false, pe: 20.35, industry: '消费' }
                ]
            }
        ];

        // 行业分类数据
        const industries = [
            '银行', '保险', '证券', '房地产', '建筑建材', '电子', '计算机', '通信', 
            '医药生物', '食品饮料', '家用电器', '汽车', '机械设备', '电气设备', 
            '公用事业', '交通运输', '采掘', '化工', '纺织服装', '钢铁', '有色金属',
            '半导体', '新能源', '人工智能', '消费'
        ];

        // 趋势分析数据
        const trendData = {
            marketSentiment: '震荡乐观',
            northwardFunds: '+35.42',
            advanceDeclineRatio: '1.87',
            marketTrend: '震荡上行',
            analysis: '市场整体维持震荡上行趋势，北向资金持续大幅流入，科技股和消费板块表现突出。关注政策面变化及下周一美股表现对A股的影响。'
        };

        // 获取所有龙头股
        const getAllLeadingStocks = () => {
            let leadingStocks = [];
            leadingSectors.forEach(sector => {
                sector.stocks.forEach(stock => {
                    if (stock.isLeader) {
                        leadingStocks.push({...stock, sector: sector.name});
                    }
                });
            });
            return leadingStocks;
        };

        // 从龙头板块中提取所有股票
        const getAllSectorStocks = () => {
            let allSectorStocks = [];
            leadingSectors.forEach(sector => {
                sector.stocks.forEach(stock => {
                    allSectorStocks.push({...stock, sector: sector.name});
                });
            });
            return allSectorStocks;
        };

        // 更新A股数据 - 模拟最新数据
        const allStocks = [
            { code: '600000', name: '浦发银行', price: 9.73, change: 0.42, changePercent: 4.51, volume: 1732.65, turnover: 16.87, pe: 6.98, industry: '银行' },
            { code: '600036', name: '招商银行', price: 41.57, change: 1.46, changePercent: 3.64, volume: 1523.42, turnover: 63.28, pe: 9.35, industry: '银行' },
            { code: '601398', name: '工商银行', price: 5.42, change: 0.22, changePercent: 4.23, volume: 2823.54, turnover: 15.32, pe: 5.21, industry: '银行' },
            { code: '601318', name: '中国平安', price: 48.32, change: -0.65, changePercent: -1.33, volume: 1923.45, turnover: 92.87, pe: 9.85, industry: '保险' },
            { code: '600519', name: '贵州茅台', price: 1678.45, change: 18.75, changePercent: 1.13, volume: 132.37, turnover: 222.18, pe: 27.32, industry: '食品饮料' },
            { code: '000858', name: '五粮液', price: 176.32, change: 3.12, changePercent: 1.80, volume: 612.45, turnover: 108.59, pe: 22.15, industry: '食品饮料' },
            { code: '002415', name: '海康威视', price: 33.45, change: 0.98, changePercent: 3.02, volume: 1345.23, turnover: 45.02, pe: 14.32, industry: '电子' },
            { code: '000333', name: '美的集团', price: 56.74, change: 1.45, changePercent: 2.62, volume: 1032.87, turnover: 58.85, pe: 11.85, industry: '家用电器' },
            { code: '600276', name: '恒瑞医药', price: 34.12, change: 0.35, changePercent: 1.04, volume: 932.54, turnover: 31.82, pe: 33.21, industry: '医药生物' },
            { code: '601166', name: '兴业银行', price: 18.23, change: 1.05, changePercent: 6.11, volume: 1456.32, turnover: 26.58, pe: 5.98, industry: '银行' },
            
            // 更多股票数据...
            { code: '600887', name: '伊利股份', price: 28.65, change: 0.32, changePercent: 1.13, volume: 912.43, turnover: 26.21, pe: 20.35, industry: '食品饮料' },
            { code: '601988', name: '中国银行', price: 3.92, change: 0.12, changePercent: 3.16, volume: 3532.65, turnover: 13.85, pe: 4.87, industry: '银行' },
            { code: '600030', name: '中信证券', price: 24.37, change: 1.45, changePercent: 6.33, volume: 1734.52, turnover: 42.28, pe: 13.76, industry: '证券' },
            { code: '000651', name: '格力电器', price: 39.15, change: 0.65, changePercent: 1.69, volume: 832.54, turnover: 32.59, pe: 9.32, industry: '家用电器' },
            { code: '601888', name: '中国中免', price: 157.85, change: 1.45, changePercent: 0.93, volume: 387.42, turnover: 61.15, pe: 29.85, industry: '商业贸易' },
            
            // 更多新增高科技股票数据
            { code: '601360', name: '三六零', price: 15.76, change: 0.54, changePercent: 3.55, volume: 732.65, turnover: 11.55, pe: 35.67, industry: '计算机' },
            { code: '688981', name: '中芯国际', price: 58.42, change: 3.65, changePercent: 6.67, volume: 563.45, turnover: 32.92, pe: 28.75, industry: '半导体' },
            { code: '002230', name: '科大讯飞', price: 45.65, change: 1.75, changePercent: 3.99, volume: 752.36, turnover: 34.35, pe: 72.35, industry: '人工智能' },
            { code: '300750', name: '宁德时代', price: 187.32, change: 4.25, changePercent: 2.32, volume: 356.42, turnover: 66.74, pe: 35.87, industry: '新能源' },
            { code: '688017', name: '绿的谐波', price: 78.65, change: 3.28, changePercent: 4.35, volume: 213.45, turnover: 16.78, pe: 47.36, industry: '机械设备' },
            
            // 添加更多股票数据，增加总数量
            { code: '600104', name: '上汽集团', price: 12.78, change: 0.34, changePercent: 2.73, volume: 1023.57, turnover: 13.08, pe: 10.25, industry: '汽车' },
            { code: '600048', name: '保利发展', price: 11.52, change: 0.23, changePercent: 2.04, volume: 1432.87, turnover: 16.49, pe: 5.86, industry: '房地产' },
            { code: '688017', name: '绿的谐波', price: 78.65, change: 3.28, changePercent: 4.35, volume: 213.45, turnover: 16.78, pe: 47.36, industry: '机械设备' }
        ];

        // 将龙头板块的股票合并到总股票列表
        const mergeStocksData = () => {
            try {
                const sectorStocks = getAllSectorStocks();
                
                console.log(`龙头板块股票数: ${sectorStocks.length}`);
                console.log(`合并前总股票数: ${allStocks.length}`);
                
                // 创建一个集合来存储已有的股票代码，以防重复
                const existingStockCodes = new Set(allStocks.map(stock => stock.code));
                
                // 将不重复的龙头板块股票添加到总列表
                sectorStocks.forEach(stock => {
                    if (!existingStockCodes.has(stock.code)) {
                        // 确保股票有必要的属性
                        if (!stock.volume) stock.volume = 100;
                        if (!stock.turnover) stock.turnover = 10;
                        
                        allStocks.push({...stock});
                        existingStockCodes.add(stock.code);
                        console.log(`添加了新股票: ${stock.code} ${stock.name}`);
                    }
                });
                
                // 确保所有股票都有行业属性
                allStocks.forEach(stock => {
                    if (!stock.industry) {
                        // 从龙头板块中查找行业信息
                        for (const sector of leadingSectors) {
                            const matchStock = sector.stocks.find(s => s.code === stock.code);
                            if (matchStock) {
                                stock.industry = matchStock.industry || sector.name;
                                break;
                            }
                        }
                        
                        // 如果仍然没有行业，设置默认值
                        if (!stock.industry) {
                            stock.industry = '其他';
                        }
                    }
                });
                
                console.log(`合并后总股票数: ${allStocks.length}`);
            } catch (error) {
                console.error('合并股票数据出错:', error);
            }
        };

        // 当前页面显示的股票数据
        let currentStocks = [...allStocks];
        // 当前页码
        let currentPage = 1;
        // 每页显示数量
        const itemsPerPage = 10; // 修改为每页10条
        // 当前排序方式
        let currentSort = {
            column: 'code',
            direction: 'asc'
        };

        // 绘制趋势图
        function drawTrendChart() {
            const chartElement = document.getElementById('trendChart');
            
            // 确保清空内容
            chartElement.innerHTML = '';
            
            // 创建一个新的SVG图表
            const chartHTML = `
                <div style="width:100%; height:100%; display:flex; flex-direction:column; justify-content:center; align-items:center; position:relative;">
                    <div style="font-size:1.2rem; color:#666; margin-bottom:10px;">上证指数近30日走势</div>
                    <div style="width:90%; height:70%; position:relative;">
                        <svg width="100%" height="100%" viewBox="0 0 1000 300" preserveAspectRatio="none">
                            <path d="M0,250 L50,240 L100,245 L150,230 L200,235 L250,220 L300,215 L350,225 L400,210 L450,190 L500,195 L550,180 L600,175 L650,185 L700,170 L750,160 L800,165 L850,145 L900,130 L950,120 L1000,115" 
                                  fill="none" stroke="#e74c3c" stroke-width="3"/>
                            <path d="M0,250 L50,240 L100,245 L150,230 L200,235 L250,220 L300,215 L350,225 L400,210 L450,190 L500,195 L550,180 L600,175 L650,185 L700,170 L750,160 L800,165 L850,145 L900,130 L950,120 L1000,115" 
                                  fill="rgba(231, 76, 60, 0.1)" stroke="none"/>
                            
                            <!-- 横轴标记 -->
                            <line x1="0" y1="280" x2="1000" y2="280" stroke="#ddd" stroke-width="1"/>
                            
                            <!-- 标记点 -->
                            <circle cx="1000" cy="115" r="5" fill="#e74c3c"/>
                        </svg>
                    </div>
                    <div style="width:90%; display:flex; justify-content:space-between; color:#666; font-size:0.8rem;">
                        <span>2025-04-30</span>
                        <span>2025-05-30</span>
                    </div>
                </div>
            `;
            
            chartElement.innerHTML = chartHTML;
            console.log("趋势图绘制完成");
        }

        // 初始化函数
        function init() {
            console.log("初始化开始...");
            
            // 合并数据 - 确保首先执行这一步
            console.log(`初始化前总股票数: ${allStocks.length}`);
            mergeStocksData();
            // 添加更多模拟数据
            generateMoreStocks(100);
            console.log(`合并和生成后总股票数: ${allStocks.length}`);
            
            // 确保currentPage从1开始
            currentPage = 1;
            
            // 更新趋势分析
            updateTrendAnalysis();
            // 绘制图表
            drawTrendChart();
            // 渲染市场指数
            renderMarketIndices();
            // 渲染板块和股票数据
            renderLeadingSectors();
            renderIndustrySectors();
            renderLeadingStocks();
            // 填充过滤选项
            populateIndustryFilter();
            // 渲染股票表格
            renderStockTable();
            // 设置事件监听
            setupEventListeners();
            // 更新时间
            updateTime();
            // 初始化股票趋势分析看板
            initTrendDashboard();
            
            console.log("初始化完成");
        }
        
        // 生成更多股票数据
        function generateMoreStocks(count) {
            const industryList = [
                '银行', '保险', '证券', '房地产', '建筑建材', '电子', '计算机', '通信', 
                '医药生物', '食品饮料', '家用电器', '汽车', '机械设备', '电气设备', 
                '公用事业', '交通运输', '采掘', '化工', '纺织服装', '钢铁', '有色金属',
                '半导体', '新能源', '人工智能', '消费'
            ];
            
            const namePrefix = ['中', '国', '博', '华', '联', '达', '科', '大', '小', '新', '老', '光', '高', '远', '通', '银', '金', '创', '先', '万'];
            const nameSuffix = ['科技', '电子', '能源', '通信', '建设', '发展', '集团', '股份', '信息', '制造', '材料', '生物', '医药', '金融', '控股'];
            
            // 确保不会生成重复代码
            const existingCodes = new Set(allStocks.map(stock => stock.code));
            
            // 生成指定数量的股票
            for (let i = 0; i < count; i++) {
                // 生成6位股票代码
                let code;
                do {
                    const prefix = Math.random() < 0.5 ? '60' : (Math.random() < 0.5 ? '00' : '30');
                    const suffix = Math.floor(Math.random() * 10000).toString().padStart(4, '0');
                    code = prefix + suffix;
                } while (existingCodes.has(code));
                
                // 记录已使用的代码
                existingCodes.add(code);
                
                // 生成股票名称
                const name = namePrefix[Math.floor(Math.random() * namePrefix.length)] + 
                             namePrefix[Math.floor(Math.random() * namePrefix.length)] + 
                             nameSuffix[Math.floor(Math.random() * nameSuffix.length)];
                
                // 生成其他数据
                const price = +(Math.random() * 50 + 5).toFixed(2);
                const changePercent = +(Math.random() * 6 - 1).toFixed(2); // -1% 到 +5% 的涨跌幅
                const change = +(price * changePercent / 100).toFixed(2);
                const volume = +(Math.random() * 2000 + 100).toFixed(2);
                const turnover = +(volume * price / 100).toFixed(2);
                const pe = +(Math.random() * 40 + 5).toFixed(2);
                const industry = industryList[Math.floor(Math.random() * industryList.length)];
                
                // 添加到股票列表
                allStocks.push({
                    code, 
                    name, 
                    price, 
                    change, 
                    changePercent, 
                    volume, 
                    turnover, 
                    pe, 
                    industry
                });
            }
            
            console.log(`生成了 ${count} 只新股票`);
        }
        
        // 立即执行初始化
        document.addEventListener('DOMContentLoaded', function() {
            // 确保DOM加载完成后立即执行init
            console.log("DOM已加载，执行初始化");
            try {
                init();
            } catch (error) {
                console.error("初始化出错:", error);
                alert("页面初始化出错，请刷新重试");
            }
        });
        
        // 新增：初始化股票趋势分析看板
        function initTrendDashboard() {
            try {
                // 检查元素是否存在
                const hotSectorsElement = document.getElementById('hotSectors');
                const topGainersElement = document.getElementById('topGainers');
                const volumeChangeElement = document.getElementById('volumeChange');
                const technicalElement = document.getElementById('technicalIndicators');
                const dashboardUpdateTime = document.getElementById('dashboardUpdateTime');
                
                // 如果元素不存在，记录错误并返回
                if (!hotSectorsElement || !topGainersElement || !volumeChangeElement || !technicalElement || !dashboardUpdateTime) {
                    console.error('股票趋势分析看板元素未找到');
                    return;
                }
                
                // 更新数据
                updateTrendDashboard();
                dashboardUpdateTime.textContent = `更新时间: ${new Date().toLocaleString('zh-CN')}`;
                console.log('股票趋势分析看板初始化完成');
            } catch (error) {
                console.error('初始化股票趋势分析看板出错:', error);
            }
        }
        
        // 新增：更新股票趋势分析看板数据
        function updateTrendDashboard() {
            // 计算热门板块
            updateHotSectors();
            // 计算领涨个股
            updateTopGainers();
            // 计算成交量异动
            updateVolumeChange();
            // 更新技术指标
            updateTechnicalIndicators();
        }
        
        // 更新热门板块
        function updateHotSectors() {
            const hotSectorsElement = document.getElementById('hotSectors');
            
            // 按涨跌幅排序板块
            const sortedSectors = [...leadingSectors].sort((a, b) => b.change - a.change);
            
            // 生成HTML
            let html = '';
            sortedSectors.forEach(sector => {
                const isPositive = sector.change >= 0;
                html += `
                    <div class="trend-item-row">
                        <div class="trend-item-name">${sector.name}</div>
                        <div class="trend-item-value ${isPositive ? 'trend-value-up' : 'trend-value-down'}">
                            ${isPositive ? '+' : ''}${sector.change.toFixed(2)}%
                        </div>
                    </div>
                `;
            });
            
            hotSectorsElement.innerHTML = html;
        }
        
        // 更新领涨个股
        function updateTopGainers() {
            const topGainersElement = document.getElementById('topGainers');
            
            // 获取涨幅最高的5只股票
            const topStocks = [...allStocks]
                .sort((a, b) => b.changePercent - a.changePercent)
                .slice(0, 5);
            
            // 生成HTML
            let html = '';
            topStocks.forEach(stock => {
                html += `
                    <div class="trend-item-row">
                        <div class="trend-item-name">${stock.name} <span style="color: #666; font-size: 0.8rem;">${stock.code}</span></div>
                        <div class="trend-item-value trend-value-up">+${stock.changePercent.toFixed(2)}%</div>
                    </div>
                `;
            });
            
            topGainersElement.innerHTML = html;
        }
        
        // 更新成交量异动
        function updateVolumeChange() {
            const volumeChangeElement = document.getElementById('volumeChange');
            
            // 获取成交量最大的5只股票
            const volumeStocks = [...allStocks]
                .sort((a, b) => b.volume - a.volume)
                .slice(0, 5);
            
            // 生成HTML
            let html = '';
            volumeStocks.forEach(stock => {
                const volumeText = stock.volume > 1000 ? 
                    `${(stock.volume / 1000).toFixed(2)}万手` : 
                    `${stock.volume.toFixed(2)}万手`;
                
                html += `
                    <div class="trend-item-row">
                        <div class="trend-item-name">${stock.name} <span style="color: #666; font-size: 0.8rem;">${stock.code}</span></div>
                        <div class="trend-item-value">${volumeText}</div>
                    </div>
                `;
            });
            
            volumeChangeElement.innerHTML = html;
        }
        
        // 更新技术指标
        function updateTechnicalIndicators() {
            const technicalElement = document.getElementById('technicalIndicators');
            
            // 模拟技术指标数据
            const technicalData = {
                macd: { value: '多头', percent: 68 },
                kdj: { value: '中性', percent: 52 },
                rsi: { value: '超买', percent: 82 },
                boll: { value: '上轨突破', percent: 75 }
            };
            
            // 生成HTML
            let html = '';
            
            // MACD指标
            html += `
                <div class="indicator-line">
                    <div class="indicator-title">MACD指标</div>
                    <div class="indicator-value">${technicalData.macd.value}</div>
                    <div class="indicator-bar">
                        <div class="indicator-progress indicator-bull" style="width: ${technicalData.macd.percent}%"></div>
                    </div>
                </div>
            `;
            
            // KDJ指标
            html += `
                <div class="indicator-line">
                    <div class="indicator-title">KDJ指标</div>
                    <div class="indicator-value">${technicalData.kdj.value}</div>
                    <div class="indicator-bar">
                        <div class="indicator-progress indicator-neutral" style="width: ${technicalData.kdj.percent}%"></div>
                    </div>
                </div>
            `;
            
            // RSI指标
            html += `
                <div class="indicator-line">
                    <div class="indicator-title">RSI指标</div>
                    <div class="indicator-value">${technicalData.rsi.value}</div>
                    <div class="indicator-bar">
                        <div class="indicator-progress indicator-bull" style="width: ${technicalData.rsi.percent}%"></div>
                    </div>
                </div>
            `;
            
            // BOLL指标
            html += `
                <div class="indicator-line">
                    <div class="indicator-title">BOLL指标</div>
                    <div class="indicator-value">${technicalData.boll.value}</div>
                    <div class="indicator-bar">
                        <div class="indicator-progress indicator-bull" style="width: ${technicalData.boll.percent}%"></div>
                    </div>
                </div>
            `;
            
            technicalElement.innerHTML = html;
        }
        
        // 新增：实时刷新数据功能
        function realTimeRefresh() {
            const refreshButton = document.getElementById('realTimeRefresh');
            
            // 显示刷新状态
            refreshButton.classList.add('refreshing');
            refreshButton.disabled = true;
            
            // 随机生成新数据（模拟数据变化）
            setTimeout(() => {
                // 更新市场指数
                stockIndices.forEach(index => {
                    const changeValue = (Math.random() * 0.4 - 0.2).toFixed(2); // -0.2% 到 +0.2% 的变化
                    index.changePercent = parseFloat((index.changePercent + parseFloat(changeValue)).toFixed(2));
                    index.change = parseFloat((index.value * index.changePercent / 100).toFixed(2));
                    index.value = parseFloat((index.value * (1 + parseFloat(changeValue) / 100)).toFixed(2));
                });
                
                // 更新板块数据
                leadingSectors.forEach(sector => {
                    const sectorChange = (Math.random() * 0.5 - 0.2).toFixed(2); // -0.2% 到 +0.3% 的变化
                    sector.change = parseFloat((sector.change + parseFloat(sectorChange)).toFixed(2));
                    
                    // 更新板块内股票
                    sector.stocks.forEach(stock => {
                        const stockChange = (Math.random() * 0.6 - 0.3).toFixed(2); // -0.3% 到 +0.3% 的变化
                        stock.changePercent = parseFloat((stock.changePercent + parseFloat(stockChange)).toFixed(2));
                        stock.change = parseFloat((stock.price * stock.changePercent / 100).toFixed(2));
                        stock.price = parseFloat((stock.price * (1 + parseFloat(stockChange) / 100)).toFixed(2));
                    });
                });
                
                // 更新所有股票数据
                allStocks.forEach(stock => {
                    const stockChange = (Math.random() * 0.6 - 0.3).toFixed(2); // -0.3% 到 +0.3% 的变化
                    stock.changePercent = parseFloat((stock.changePercent + parseFloat(stockChange)).toFixed(2));
                    stock.change = parseFloat((stock.price * stock.changePercent / 100).toFixed(2));
                    stock.price = parseFloat((stock.price * (1 + parseFloat(stockChange) / 100)).toFixed(2));
                    
                    // 更新成交量
                    const volumeChange = (Math.random() * 0.1 + 0.01).toFixed(2); // 1% 到 11% 的变化
                    stock.volume = parseFloat((stock.volume * (1 + parseFloat(volumeChange))).toFixed(2));
                    stock.turnover = parseFloat((stock.turnover * (1 + parseFloat(volumeChange))).toFixed(2));
                });
                
                // 更新页面数据
                updateTrendAnalysis();
                drawTrendChart();
                renderMarketIndices();
                renderLeadingSectors();
                renderIndustrySectors(); 
                renderLeadingStocks();
                renderStockTable();
                updateTrendDashboard();
                
                // 更新时间
                updateTime();
                document.getElementById('dashboardUpdateTime').textContent = `更新时间: ${new Date().toLocaleString('zh-CN')}`;
                
                // 重置按钮状态
                refreshButton.classList.remove('refreshing');
                refreshButton.disabled = false;
                
                // 显示刷新成功消息
                alert('数据已更新至最新状态！');
            }, 1000);
        }

        function updateTime() {
            // 获取当前时间
            const now = new Date();
            const timeString = now.toLocaleString('zh-CN', {
                year: 'numeric',
                month: '2-digit',
                day: '2-digit',
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit',
                hour12: false
            });
            
            document.getElementById('updateTime').textContent = `更新时间：${timeString}`;
        }

        // 获取实时A股数据的说明
        /*
        在实际应用中，您应该使用股票数据API获取实时数据，例如：
        1. 新浪财经API（非官方，有访问限制）
        2. 东方财富API（需要申请）
        3. 聚合数据、百度股市通等第三方数据服务（大多需要付费）
        4. 各大券商提供的API（需要开户）
        
        示例API请求（新浪财经）：
        fetch('https://hq.sinajs.cn/list=sh600000,sh600036,sh601398')
            .then(response => response.text())
            .then(data => {
                // 解析返回的数据
                console.log(data);
            })
            .catch(error => {
                console.error('获取数据失败:', error);
            });
            
        注意：由于跨域限制和各种访问控制，直接在浏览器中使用这些API可能会失败。
        生产环境中应该使用自己的后端服务器作为中间层获取和处理数据。
        */

        // 添加点击事件监听到可点击的股票名称和代码
        function addStockClickListeners() {
            // 先移除所有已存在的点击事件，防止重复绑定
            const clickables = document.querySelectorAll('.clickable');
            clickables.forEach(element => {
                const newElement = element.cloneNode(true);
                element.parentNode.replaceChild(newElement, element);
            });
            
            // 重新添加点击事件
            const newClickables = document.querySelectorAll('.clickable');
            newClickables.forEach(element => {
                element.addEventListener('click', function() {
                    const stockCode = this.dataset.stock;
                    showStockDetails(stockCode);
                });
            });
        }

        // 添加股票详情
        function showStockDetails(stockCode) {
            // 先关闭所有已经存在的模态窗口
            const existingModals = document.querySelectorAll('.modal');
            existingModals.forEach(modal => {
                modal.style.display = 'none';
                modal.remove();
            });
            
            // 查找股票详情
            const stock = allStocks.find(s => s.code === stockCode);
            if (!stock) return;
            
            // 检查是否为龙头股
            const isLeader = leadingSectors.some(sector => 
                sector.stocks.some(s => s.code === stock.code && s.isLeader)
            );
            
            // 找到股票所属的板块
            let stockSector = '';
            leadingSectors.forEach(sector => {
                sector.stocks.forEach(s => {
                    if (s.code === stock.code) {
                        stockSector = sector.name;
                    }
                });
            });
            
            if (!stockSector && stock.industry) {
                stockSector = stock.industry;
            }
            
            // 获取当前时间
            const now = new Date();
            const currentTime = now.toLocaleString('zh-CN', {
                year: 'numeric',
                month: '2-digit',
                day: '2-digit',
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit',
                hour12: false
            });
            
            // 创建模态窗口
            const modal = document.createElement('div');
            modal.className = 'modal';
            modal.id = 'stockDetailModal';
            
            const isPositive = stock.changePercent >= 0;
            
            modal.innerHTML = `
                <div class="modal-content">
                    <span class="close-modal">&times;</span>
                    
                    <div class="stock-detail-header">
                        <div>
                            <div class="stock-detail-title">${stock.name} ${isLeader ? '<span class="leader-badge">龙头</span>' : ''}</div>
                            <div class="stock-detail-code">
                                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="vertical-align: -0.2em; margin-right: 6px;">
                                    <path d="M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"></path>
                                    <line x1="12" y1="8" x2="12" y2="16"></line>
                                    <line x1="8" y1="12" x2="16" y2="12"></line>
                                </svg>
                                ${stock.code}
                            </div>
                        </div>
                        <div style="text-align: right;">
                            <div class="stock-detail-price">${stock.price.toFixed(2)}</div>
                            <div class="stock-detail-change ${isPositive ? 'positive' : 'negative'}">
                                ${isPositive ? '+' : ''}${stock.changePercent.toFixed(2)}%
                            </div>
                        </div>
                    </div>
                    
                    <div class="stock-detail-grid">
                        <div class="detail-item">
                            <div class="detail-label">所属板块</div>
                            <div class="detail-value">${stockSector || '未知'}</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">市盈率(倍)</div>
                            <div class="detail-value">${stock.pe.toFixed(2)}</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">成交量(万手)</div>
                            <div class="detail-value">${stock.volume.toFixed(2)}</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">成交额(亿)</div>
                            <div class="detail-value">${stock.turnover.toFixed(2)}</div>
                        </div>
                    </div>
                    
                    <p style="margin-top: 20px; color: #666; font-size: 0.9rem; text-align: center;">
                        数据更新时间：${currentTime}
                    </p>
                </div>
            `;
            
            // 添加到页面
            document.body.appendChild(modal);
            
            // 显示模态窗口
            modal.style.display = 'block';
            
            // 关闭模态窗口
            const closeBtn = modal.querySelector('.close-modal');
            closeBtn.addEventListener('click', function() {
                modal.style.display = 'none';
                setTimeout(() => {
                    modal.remove();
                }, 300);
            });
            
            // 点击模态窗口外部关闭
            modal.addEventListener('click', function(event) {
                if (event.target === modal) {
                    modal.style.display = 'none';
                    setTimeout(() => {
                        modal.remove();
                    }, 300);
                }
            });
        }

        // 刷新按钮
        document.getElementById('refreshBtn').addEventListener('click', () => {
            // 在实际应用中，这里应该重新从API获取数据
            updateTime();
            renderStockTable();
        });
        
        // 实时刷新按钮
        document.getElementById('realTimeRefresh').addEventListener('click', () => {
            realTimeRefresh();
        });

        // 设置事件监听
        function setupEventListeners() {
            // 搜索按钮
            document.getElementById('searchBtn').addEventListener('click', () => {
                currentPage = 1; // 重置到第一页
                renderStockTable();
            });
            
            // 搜索输入框回车
            document.getElementById('searchInput').addEventListener('keyup', (e) => {
                if (e.key === 'Enter') {
                    currentPage = 1; // 重置到第一页
                    renderStockTable();
                }
            });
            
            // 行业过滤器变化
            document.getElementById('industryFilter').addEventListener('change', () => {
                currentPage = 1; // 重置到第一页
                renderStockTable();
            });
            
            // 排序选项变化
            document.getElementById('sortOption').addEventListener('change', () => {
                currentPage = 1; // 重置到第一页
                renderStockTable();
            });
            
            // 表头排序
            const tableHeaders = document.querySelectorAll('th[data-sort]');
            tableHeaders.forEach(header => {
                header.addEventListener('click', () => {
                    const column = header.getAttribute('data-sort');
                    
                    // 切换排序方向
                    if (currentSort.column === column) {
                        currentSort.direction = currentSort.direction === 'asc' ? 'desc' : 'asc';
                    } else {
                        currentSort.column = column;
                        currentSort.direction = 'asc';
                    }
                    
                    // 根据排序列和方向进行排序
                    currentStocks.sort((a, b) => {
                        let valueA = a[column];
                        let valueB = b[column];
                        
                        // 字符串比较
                        if (typeof valueA === 'string') {
                            return currentSort.direction === 'asc' 
                                ? valueA.localeCompare(valueB) 
                                : valueB.localeCompare(valueA);
                        }
                        
                        // 数值比较
                        return currentSort.direction === 'asc' 
                            ? valueA - valueB 
                            : valueB - valueA;
                    });
                    
                    currentPage = 1; // 重置到第一页
                    renderStockTable();
                });
            });
            
            // 板块标签页切换
            const tabs = document.querySelectorAll('.tab');
            tabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    // 移除所有标签页的active类
                    tabs.forEach(t => t.classList.remove('active'));
                    
                    // 隐藏所有内容
                    document.querySelectorAll('.tab-content').forEach(content => {
                        content.classList.remove('active');
                    });
                    
                    // 激活当前标签页
                    tab.classList.add('active');
                    
                    // 显示对应内容
                    const tabId = tab.getAttribute('data-tab');
                    document.getElementById(tabId).classList.add('active');
                });
            });

            // 重置按钮
            document.querySelector('.reset-button').addEventListener('click', () => {
                // 重置搜索输入框和行业过滤器
                document.getElementById('searchInput').value = '';
                document.getElementById('industryFilter').value = '';
                // 重置排序选项
                document.getElementById('sortOption').value = 'default';
                // 重置当前页码
                currentPage = 1;
                // 重新渲染股票表格
                renderStockTable();
            });
        }
        
        // 渲染市场指数
        function renderMarketIndices() {
            try {
                const indexContainer = document.getElementById('marketIndex');
                if (!indexContainer) {
                    console.error('市场指数容器元素未找到');
                    return;
                }
                
                let html = '';
                stockIndices.forEach(index => {
                    const isPositive = index.changePercent >= 0;
                    html += `
                        <div class="index-card">
                            <div class="index-name">${index.name}</div>
                            <div class="index-value">${index.value.toFixed(2)}</div>
                            <div class="index-change ${isPositive ? 'positive' : 'negative'}">
                                ${isPositive ? '+' : ''}${index.changePercent.toFixed(2)}%
                            </div>
                        </div>
                    `;
                });
                
                indexContainer.innerHTML = html;
                console.log('市场指数渲染完成');
            } catch (error) {
                console.error('渲染市场指数出错:', error);
            }
        }
        
        // 更新趋势分析
        function updateTrendAnalysis() {
            try {
                // 更新市场情绪
                document.getElementById('marketSentiment').textContent = trendData.marketSentiment;
                // 更新北向资金
                document.getElementById('northwardFunds').textContent = trendData.northwardFunds;
                // 更新涨跌比
                document.getElementById('advanceDeclineRatio').textContent = trendData.advanceDeclineRatio;
                // 更新大盘趋势
                document.getElementById('marketTrend').textContent = trendData.marketTrend;
                document.getElementById('marketTrend2').textContent = trendData.marketTrend;
                
                console.log('趋势分析更新完成');
            } catch (error) {
                console.error('更新趋势分析出错:', error);
            }
        }
        
        // 渲染龙头板块
        function renderLeadingSectors() {
            try {
                const sectorContainer = document.getElementById('leading-sectors');
                if (!sectorContainer) {
                    console.error('龙头板块容器元素未找到');
                    return;
                }
                
                let html = '';
                leadingSectors.forEach(sector => {
                    const isPositive = sector.change >= 0;
                    
                    html += `
                        <div class="sector-card">
                            <div class="sector-header">
                                <div class="sector-title">${sector.name}</div>
                                <div class="sector-change ${isPositive ? 'positive' : 'negative'}">
                                    ${isPositive ? '+' : ''}${sector.change.toFixed(2)}%
                                </div>
                            </div>
                            <div class="sector-stocks">
                    `;
                    
                    sector.stocks.forEach(stock => {
                        const stockPositive = stock.changePercent >= 0;
                        
                        html += `
                            <div class="stock-card">
                                <div class="stock-name clickable" data-stock="${stock.code}">
                                    ${stock.name} ${stock.isLeader ? '<span class="leader-badge">龙头</span>' : ''}
                                </div>
                                <div class="stock-code clickable" data-stock="${stock.code}">${stock.code}</div>
                                <div class="stock-price ${stockPositive ? 'positive' : 'negative'}">
                                    <span class="price-value">${stock.price.toFixed(2)}</span>
                                    <span class="price-separator">&nbsp;&nbsp;</span>
                                    <span class="change-value">${stockPositive ? '+' : ''}${stock.changePercent.toFixed(2)}%</span>
                                </div>
                            </div>
                        `;
                    });
                    
                    html += `
                            </div>
                        </div>
                    `;
                });
                
                sectorContainer.innerHTML = html;
                addStockClickListeners();
                console.log('龙头板块渲染完成');
            } catch (error) {
                console.error('渲染龙头板块出错:', error);
            }
        }
        
        // 渲染行业板块
        function renderIndustrySectors() {
            try {
                const sectorContainer = document.getElementById('industry-sectors');
                if (!sectorContainer) {
                    console.error('行业板块容器元素未找到');
                    return;
                }
                
                // 按行业分组股票
                const industryGroups = {};
                industries.forEach(industry => {
                    industryGroups[industry] = [];
                });
                
                allStocks.forEach(stock => {
                    if (stock.industry && industryGroups[stock.industry]) {
                        industryGroups[stock.industry].push(stock);
                    }
                });
                
                let html = '';
                
                // 只显示有股票的行业
                Object.keys(industryGroups).forEach(industry => {
                    if (industryGroups[industry].length > 0) {
                        // 计算行业平均涨跌幅
                        let totalChange = 0;
                        industryGroups[industry].forEach(stock => {
                            totalChange += stock.changePercent;
                        });
                        const avgChange = totalChange / industryGroups[industry].length;
                        const isPositive = avgChange >= 0;
                        
                        html += `
                            <div class="sector-card">
                                <div class="sector-header">
                                    <div class="sector-title">${industry}</div>
                                    <div class="sector-change ${isPositive ? 'positive' : 'negative'}">
                                        ${isPositive ? '+' : ''}${avgChange.toFixed(2)}%
                                    </div>
                                </div>
                                <div class="sector-stocks">
                        `;
                        
                        // 只显示前4只股票
                        const topStocks = industryGroups[industry]
                            .sort((a, b) => b.changePercent - a.changePercent)
                            .slice(0, 4);
                            
                        topStocks.forEach(stock => {
                            const stockPositive = stock.changePercent >= 0;
                            
                            html += `
                                <div class="stock-card">
                                    <div class="stock-name clickable" data-stock="${stock.code}">
                                        ${stock.name}
                                    </div>
                                    <div class="stock-code clickable" data-stock="${stock.code}">${stock.code}</div>
                                    <div class="stock-price ${stockPositive ? 'positive' : 'negative'}">
                                        <span class="price-value">${stock.price.toFixed(2)}</span>
                                        <span class="price-separator">&nbsp;&nbsp;</span>
                                        <span class="change-value">${stockPositive ? '+' : ''}${stock.changePercent.toFixed(2)}%</span>
                                    </div>
                                </div>
                            `;
                        });
                        
                        html += `
                                </div>
                            </div>
                        `;
                    }
                });
                
                sectorContainer.innerHTML = html;
                addStockClickListeners();
                console.log('行业板块渲染完成');
            } catch (error) {
                console.error('渲染行业板块出错:', error);
            }
        }
        
        // 渲染龙头股票列表
        function renderLeadingStocks() {
            try {
                const stockListElement = document.getElementById('leadingStocksList');
                if (!stockListElement) {
                    console.error('龙头股票列表元素未找到');
                    return;
                }
                
                const leadingStocks = getAllLeadingStocks();
                
                // 生成HTML
                let html = '';
                leadingStocks.forEach(stock => {
                    const isPositive = stock.changePercent >= 0;
                    
                    html += `
                        <tr>
                            <td>
                                <span class="clickable" data-stock="${stock.code}">${stock.code}</span>
                            </td>
                            <td>
                                <span class="clickable" data-stock="${stock.code}">${stock.name}</span>
                            </td>
                            <td>${stock.sector}</td>
                            <td>${stock.price.toFixed(2)}</td>
                            <td class="${isPositive ? 'positive' : 'negative'}">
                                ${isPositive ? '+' : ''}${stock.changePercent.toFixed(2)}%
                            </td>
                            <td>${stock.pe.toFixed(2)}</td>
                        </tr>
                    `;
                });
                
                stockListElement.innerHTML = html;
                addStockClickListeners();
                console.log('龙头股票列表渲染完成');
            } catch (error) {
                console.error('渲染龙头股票列表出错:', error);
            }
        }
        
        // 填充行业过滤器
        function populateIndustryFilter() {
            try {
                const industryFilter = document.getElementById('industryFilter');
                if (!industryFilter) {
                    console.error('行业过滤器元素未找到');
                    return;
                }
                
                // 清空既有选项，保留第一个"全部行业"选项
                while (industryFilter.options.length > 1) {
                    industryFilter.remove(1);
                }
                
                // 添加行业选项
                industries.forEach(industry => {
                    const option = document.createElement('option');
                    option.value = industry;
                    option.textContent = industry;
                    industryFilter.appendChild(option);
                });
                
                console.log('行业过滤器填充完成');
            } catch (error) {
                console.error('填充行业过滤器出错:', error);
            }
        }
        
        // 渲染股票表格
        function renderStockTable() {
            try {
                // 显示加载指示器
                document.getElementById('loading').style.display = 'block';
                
                // 获取搜索关键词
                const searchKeyword = document.getElementById('searchInput').value.toLowerCase();
                // 获取行业过滤条件
                const industryFilter = document.getElementById('industryFilter').value;
                // 获取排序选项
                const sortOption = document.getElementById('sortOption').value;
                
                // 应用过滤条件
                let filteredStocks = allStocks.filter(stock => {
                    // 搜索过滤
                    if (searchKeyword && !stock.name.toLowerCase().includes(searchKeyword) && !stock.code.includes(searchKeyword)) {
                        return false;
                    }
                    
                    // 行业过滤
                    if (industryFilter && stock.industry !== industryFilter) {
                        return false;
                    }
                    
                    return true;
                });
                
                // 应用排序
                switch(sortOption) {
                    case 'priceAsc':
                        filteredStocks.sort((a, b) => a.price - b.price);
                        break;
                    case 'priceDesc':
                        filteredStocks.sort((a, b) => b.price - a.price);
                        break;
                    case 'changeAsc':
                        filteredStocks.sort((a, b) => a.changePercent - b.changePercent);
                        break;
                    case 'changeDesc':
                        filteredStocks.sort((a, b) => b.changePercent - a.changePercent);
                        break;
                    case 'volumeDesc':
                        filteredStocks.sort((a, b) => b.volume - a.volume);
                        break;
                    default:
                        filteredStocks.sort((a, b) => a.code.localeCompare(b.code));
                        break;
                }
                
                // 更新当前股票列表
                currentStocks = filteredStocks;
                
                // 计算总页数
                const totalPages = Math.ceil(filteredStocks.length / itemsPerPage);
                
                // 确保当前页码有效
                if (currentPage < 1) currentPage = 1;
                if (currentPage > totalPages) currentPage = totalPages;
                
                // 获取当前页的数据
                const startIndex = (currentPage - 1) * itemsPerPage;
                const endIndex = Math.min(startIndex + itemsPerPage, filteredStocks.length);
                const currentPageData = filteredStocks.slice(startIndex, endIndex);
                
                // 填充表格
                const stockList = document.getElementById('stockList');
                if (!stockList) {
                    console.error('股票列表元素未找到');
                    document.getElementById('loading').style.display = 'none';
                    return;
                }
                
                if (currentPageData.length === 0) {
                    stockList.innerHTML = `
                        <tr>
                            <td colspan="7" class="empty-data-message">未找到符合条件的股票数据</td>
                        </tr>
                    `;
                } else {
                    let html = '';
                    currentPageData.forEach(stock => {
                        const isPositive = stock.changePercent >= 0;
                        
                        html += `
                            <tr>
                                <td>
                                    <span class="clickable" data-stock="${stock.code}">${stock.code}</span>
                                </td>
                                <td>
                                    <span class="clickable" data-stock="${stock.code}">${stock.name}</span>
                                </td>
                                <td>${stock.price.toFixed(2)}</td>
                                <td class="${isPositive ? 'positive' : 'negative'}">
                                    ${isPositive ? '+' : ''}${stock.changePercent.toFixed(2)}%
                                </td>
                                <td>${stock.volume.toFixed(2)}</td>
                                <td>${stock.turnover.toFixed(2)}</td>
                                <td>${stock.pe.toFixed(2)}</td>
                            </tr>
                        `;
                    });
                    
                    stockList.innerHTML = html;
                }
                
                // 渲染分页
                renderPagination(totalPages, filteredStocks.length);
                
                // 隐藏加载指示器
                document.getElementById('loading').style.display = 'none';
                
                // 添加点击事件监听
                addStockClickListeners();
                
                console.log('股票表格渲染完成');
            } catch (error) {
                console.error('渲染股票表格出错:', error);
                document.getElementById('loading').style.display = 'none';
            }
        }
        
        // 渲染分页
        function renderPagination(totalPages, totalItems) {
            try {
                const paginationElement = document.getElementById('pagination');
                if (!paginationElement) {
                    console.error('分页元素未找到');
                    return;
                }
                
                // 计算显示的页码
                let startPage = Math.max(1, currentPage - 2);
                let endPage = Math.min(totalPages, startPage + 4);
                
                // 如果显示页码不足5个，调整起始页
                if (endPage - startPage < 4 && totalPages > 5) {
                    startPage = Math.max(1, endPage - 4);
                }
                
                let html = `
                    <div class="pagination-info">
                        总计 <strong>${totalItems}</strong> 条数据，共 <strong>${totalPages}</strong> 页
                    </div>
                    <div class="pagination-buttons">
                        <button ${currentPage === 1 ? 'disabled' : ''} onclick="currentPage = 1; renderStockTable();">首页</button>
                        <button ${currentPage === 1 ? 'disabled' : ''} onclick="currentPage--; renderStockTable();">上一页</button>
                `;
                
                // 首页省略号
                if (startPage > 1) {
                    html += `<span class="ellipsis">...</span>`;
                }
                
                // 页码按钮
                for (let i = startPage; i <= endPage; i++) {
                    html += `
                        <button class="${i === currentPage ? 'active' : ''}" onclick="currentPage = ${i}; renderStockTable();">${i}</button>
                    `;
                }
                
                // 尾页省略号
                if (endPage < totalPages) {
                    html += `<span class="ellipsis">...</span>`;
                }
                
                html += `
                        <button ${currentPage === totalPages ? 'disabled' : ''} onclick="currentPage++; renderStockTable();">下一页</button>
                        <button ${currentPage === totalPages ? 'disabled' : ''} onclick="currentPage = ${totalPages}; renderStockTable();">末页</button>
                    </div>
                    <div class="jump-container">
                        <span class="jump-label">跳转到</span>
                        <input type="number" id="pageJump" min="1" max="${totalPages}" value="${currentPage}" class="jump-input">
                        <button class="jump-button" onclick="jumpToPage()">确定</button>
                    </div>
                `;
                
                paginationElement.innerHTML = html;
                console.log('分页渲染完成');
            } catch (error) {
                console.error('渲染分页出错:', error);
            }
        }
        
        // 跳转到指定页
        function jumpToPage() {
            try {
                const jumpInput = document.getElementById('pageJump');
                if (!jumpInput) return;
                
                let page = parseInt(jumpInput.value);
                const totalPages = Math.ceil(currentStocks.length / itemsPerPage);
                
                // 确保页码有效
                if (isNaN(page) || page < 1) {
                    page = 1;
                    alert("请输入有效页码");
                } else if (page > totalPages) {
                    page = totalPages;
                    alert(`最大页码为 ${totalPages}`);
                }
                
                currentPage = page;
                renderStockTable();
            } catch (error) {
                console.error('页码跳转出错:', error);
            }
        }
    </script>
</body>
</html>